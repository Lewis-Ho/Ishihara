'use strict';
/**
 * @ngdoc function
 * @name restaurantAppApp.controller:MainCtrl
 * @description
 * # MainCtrl
 * Controller of the restaurantAppApp
 */

var app = angular.module('starterApp');

<<<<<<< HEAD
app.controller('ResultCtrl', function ($scope, $route, $routeParams, $location, $http, $cookies, $window) {
=======
app.controller('ResultCtrl', function ($scope, $route, $routeParams, $location, $http, $cookies, $window, $stateParams) {
>>>>>>> reset-before-d3
  $scope.$route = $route;
  $scope.$location = $location;
  $scope.$routeParams = $routeParams;
  console.log("ResultCtrl");
//  console.log($routeParams);
  console.log($stateParams);
  
<<<<<<< HEAD
  var request = $http.get('/Game/Result');
  request.success(function(data){
    console.log(data);
    console.log(data.length);
=======
  // Resize charts canvas
  var w = angular.element($window);
  w.bind('resize', function () {
    console.log('resize');
    var vpw = $window.innerWidth;
    var vph = $window.innerHeight;
    console.log(vpw + " " + vph);
    var canvas = document.getElementsByClassName("chart");  
    canvas.width = vpw*.28;
  });
  
  var request = $http.get('/Game/Result');
  request.success(function(data){
    console.log(data);
//    console.log(data.length);
    
    
>>>>>>> reset-before-d3
    var score = $cookies.get('_s');
    console.log("cookies: ");
    console.log(score);
    var vpw = $window.innerWidth;
    var vph = $window.innerHeight;
    console.log(vpw);
    
    
//    var data = [
//        {
//            value: 300,
//            color:"#F7464A",
//            highlight: "#FF5A5E",
//            label: "Red"
//        },
//        {
//            value: 50,
//            color: "#46BFBD",
//            highlight: "#5AD3D1",
//            label: "Green"
//        },
//        {
//            value: 100,
//            color: "#FDB45C",
//            highlight: "#FFC870",
//            label: "Yellow"
//        }
//    ]
    //TESTING VARIABLE
    var color = ["red", "blue", "green"];
    var numberOfCorrect = [6, 5, 4];
    var TolalColorGuess = [8, 7, 5];
    var total = 20;
    
    $scope.pie1 = numberOfCorrect[0];
    $scope.pie2 = numberOfCorrect[1];
    $scope.pie3 = numberOfCorrect[2];
//    $scope.pies = [
//      { data: 6, label: "First content" },
//      { data: 5, label: "First content" },
//      { data: 4, label: "Second content" }
//    ];

    
    for(var i = 0; i <3; i++){
      $scope.labels = ["Download Sales", "In-Store Sales", "Mail-Order Sales"];
      //$scope.data = [6, 5, 4];
      $scope.pieOne = [6];
      $scope.pie2 = numberOfCorrect[1];
      $scope.pie3 = numberOfCorrect[2];
//      var c = document.getElementById("doughnut");
//      if()
//      c.width = width;
//      var myNewChart = new Chart(ctx[i]).Doughnut(data, {
//        responsive : true,
//        segmentShowStroke : true,
//        segmentStrokeColor : "#fff",
//        segmentStrokeWidth : 2,
//        animationSteps : 300,
//        animationEasing : "easeOutBounce",
//        animateRotate : true,
//        animateScale : true
//      });
    }
    
    
//    //Get the canvas &
//    var c = document.getElementById('#chart-canvas').getContext('2d');
////    var ct = c.get(0).getContext('2d');
//    var container = $(c).parent();
//
//    //Run function when browser resizes
//    $window.resize( respondCanvas );
//
//    function respondCanvas(){ 
//        c.attr('width', $(container).width() ); //max width
//        c.attr('height', $(container).height() ); //max height
//
//        //Call a function to redraw other content (texts, images etc)
//    }
//
//    //Initial call 
//    respondCanvas();
    
    
    
    var total = 0;
    for(var i = 0; i < data.length; i ++){
      total = total + data[i].score;
    }

    //var average = JSON.parse('{ "average" : "' + total/data.length + '"}');
    var average = total/data.length;
<<<<<<< HEAD
    
    var margin = {top: 30, right: 10, bottom: 30, left: 50}
 
    if (vpw > vph){
      // Desktop
      var height = vph/1.5 - margin.top - margin.bottom,
        width = vpw/4 - margin.left,
        barWidth = 60,
        barOffset = vph/6;
    } else {
      // Mobile
      var height = vph/1.5 - margin.top - margin.bottom,
        width = vpw/1.5 - margin.left,
        barWidth = 60,
        barOffset = vph/11;
    }
=======
>>>>>>> reset-before-d3

    //average-bar-chart
    var aveChartData = [ score, average ];
    
<<<<<<< HEAD
    var yScale = d3.scale.linear()
        .domain([0, d3.max(aveChartData)])
        .range([0, height])

    var xScale = d3.scale.ordinal()
        .domain(d3.range(0, aveChartData.length))
        .rangeBands([0, width])
 
    var p = d3.select('#average-bar-chart').append('svg')
              .attr('width', width + margin.left + margin.right)
              .attr('height', height + margin.top + margin.bottom)
              .append('g')
              .attr('transform', 'translate(' + (margin.left + 30) + ', ' + margin.top + ')')
              .selectAll('rect')
              .data(aveChartData)
              .enter()
              .append('rect')
              .style({'fill': 'rgb(96,125,139)', 'stroke': '#d6e9c6'})
              .attr('width', barWidth)
              .attr('height', function (data) {
                return data;
              })
              .attr('x', function (data, i) {
                return i * (barWidth + barOffset);
              })
              .attr('y', function (data) {
                return height - data;
              })
              .text(function (d,i) {
                if (i=0){
                  return "Your Score: " + d;
                } else {
                  return "Population Average: " + d;
                }
              });

    // Transition
    p.transition()
      .attr('height', function (data) {
          return yScale(data);
      })
      .attr('y', function (data) {
          return height - yScale(data);
      })
      .delay(function (data, i) {
          return i * 20;
      })
      .duration(2000)
      .ease('elastic');
    
    // Adding Horizontal and Vertical Guides
    var verticalGuideScale = d3.scale.linear()
                               .domain([0, d3.max(aveChartData)])
                               .range([height, 0])
 
    var vAxis = d3.svg.axis()
                  .scale(verticalGuideScale)
                  .orient('left')
                  .ticks(10)

    var verticalGuide = d3.select('svg').append('g')
    vAxis(verticalGuide)
    verticalGuide.attr('transform', 'translate(' + margin.left + ', ' + margin.top + ')')
    verticalGuide.selectAll('path').style({fill: 'none', stroke: "rgb(96,125,139)"})
    verticalGuide.selectAll('line').style({stroke: "rgb(96,125,139)"})

    var hAxis = d3.svg.axis()
                  .scale(xScale)
                  .tickFormat(function(d,i) { 
                    if (i == 0)
                      return 'Your Score';
                    else
                      return 'Average Score';
                  })
                  .orient('bottom')

    var horizontalGuide = d3.select('svg').append('g')
    hAxis(horizontalGuide)
    horizontalGuide.attr('transform', 'translate(' + margin.left + ', ' + (height + margin.top) + ')')
    horizontalGuide.selectAll('path').style({fill: 'none', stroke: "#3c763d"})
    horizontalGuide.selectAll('line').style({stroke: "#3c763d"});
    
//    var bar = d3.select('#bar-chart').append('svg')
//                .attr('width', width)
//                .attr('height', height)
//                .selectAll('rect').data(data)
//                .enter().append('rect')
//                .style({'fill': 'rgb(96,125,139)', 'stroke': 'rgb(96,125,139)'})
//                .attr('width', barWidth)
//                .attr('height', function (data) {
//                    return data.score;
//                })
//                .attr('x', function (data, i) {
//                    return i * (barWidth + barOffset);
//                })
//                .attr('y', function (data) {
//                    return height - data.score;
//                });
    // Circle ---
    var width = 960,
    height = 500,
    twoPi = 2 * Math.PI,
    progress = 0,
    total = 1308573, // must be hard-coded if server doesn't report Content-Length
    formatPercent = d3.format(".0%");
    
    var arc = d3.svg.arc()
        .startAngle(0)
        .innerRadius(18)
        .outerRadius(24);

    var svg = d3.select("#circular").append("svg")
        .attr("width", width)
        .attr("height", height)
      .append("g")
        .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

    var meter = svg.append("g")
        .attr("class", "progress-meter");

    meter.append("path")
        .attr("class", "background")
        .attr("d", arc.endAngle(twoPi));

    var foreground = meter.append("path")
        .attr("class", "foreground");

    var text = meter.append("text")
        .attr("text-anchor", "middle")
        .attr("dy", ".35em");

  });
  
});
=======
//    var favoriteCookie = $cookies.get('_s');
    console.log($cookies.get('_s'));
    console.log($cookies.get('_t'));
    console.log($cookies.get('_h'));
//    function type(d) {
//      d.value = +d.value; // coerce to number
//      return d;
//    }
    ///
  });
});


// Red Doughnut Chart
app.controller("pieOneCtrl", function ($scope, $window, $http, $cookies, $stateParams) {
    var request = $http.get('/Game/Result');
    request.success(function(d){
      var rating = Math.round(($cookies.get('_hr') / $cookies.get('_tr'))*100);
      $scope.labels = ['Hit', 'Miss'];
      $scope.data = [100-rating,rating];
      $scope.colours = ['#F44336 ','#DCDCDC'];
    });
  });

// Green Doughnut Chart
app.controller("pieTwoCtrl", function ($scope, $window, $http, $cookies) {
    var request = $http.get('/Game/Result');
    request.success(function(d){
      var rating = Math.round(($cookies.get('_hg') / $cookies.get('_tg'))*100);
      console.log($cookies.get('_hg'));
      $scope.labels = ['Hit', 'Miss'];
      $scope.data = [100-rating,rating];
      $scope.colours = ['#4CAF50 ','#DCDCDC'];
    });
  });

// Blue Doughnut Chart
app.controller("pieThreeCtrl", function ($scope, $window, $http, $cookies) {
    var request = $http.get('/Game/Result');
    request.success(function(d){
      var rating = Math.round(($cookies.get('_hb') / $cookies.get('_tb'))*100);
      $scope.labels = ['Hit', 'Miss'];
      $scope.data = [100-rating,rating];
      $scope.colours = ['#03A9F4 ','#DCDCDC'];
    });
  });


app.controller("resizeCtrl", function ($scope, $window, $http) {
    var request = $http.get('/Game/Result');
    request.success(function(data){
      $scope.labels = ['2006', '2007', '2008', '2009', '2010', '2011', '2012'];
      $scope.series = ['Series A', 'Series B'];

      $scope.data = [
        [65, 59, 80, 81, 56, 55, 40],
        [28, 48, 40, 19, 86, 27, 90]
      ];
    });
  });
>>>>>>> reset-before-d3
